{% extends 'base.html' %}

{% load i18n %}
{% load static %}
{% load bootstrap5 bootstrap_icons %}

{% block content %}

<h2 id="guides">
	{% translate "Guides" %}
	<a href="#guides" class="section-link">#</a>
</h2>

<p>
	{% translate "Her ligger alle de lækre guides, som er rare at have, når man involverer sig i driften af" context "Fredagscaféen" %} Fredagscaféen.
</p>
<p>
	{% translate "Vi forsøger at opdatere dem løbende, men forstå at de ikke altid afspejler virkeligheden fuldt ud." %}
</p>
<p>
	{% translate "Har du tilføjelser eller foreslag til ændringer, kan du lave et Pull Request på GitHub " %}
	<a class="common" href="https://github.com/fredagscafeen/guides" rel="external" target="_blank">{% translate "her" context "På linket her" %} {% bs_icon 'box-arrow-up-right' size='0.75em' %}</a>.
</p>

<div>
	{% for category, guides in guides %}
		<div role="tablist">
			<div class="card mb-3">
				<div class ="card-header" role="tab" id="coll">
					<div class="row">
						<div class="col-auto me-auto">
							{{ category }} <span class="badge text-bg-primary rounded-pill">{{ guides|length }}</span></li>
						</div>
					</div>
				</div>
				<div role="tabpanel">
					<div class="container" style="overflow: scroll;">
						<table class="table tablesorter">
							<thead>
								<tr>
									<th></th>
									<th class="col-8 text-secondary" scope="col">{% translate "Navn" %}</th>
									<th class="col-3 text-secondary" scope="col">{% translate "Opdateret" %}</th>
									<th class="col-1 text-secondary" scope="col">{% translate "Link" %}</th>
									{% if user.is_staff %}
										<th class="col-1"></th>
									{% endif %}
								</tr>
							</thead>
							<tbody>
								{% for guide in guides %}
									<tr>
										<td>
											{% if guide.language == 'en' %}
											<img src="{% static 'images/unionjac.png' %}" class="rounded" height="15">
											{% elif guide.language == 'da' %}
											<img src="{% static 'images/dannebro.png' %}" class="rounded" height="15">
											{% endif %}
										</td>
										<td>{{ guide.name }}</td>
										<td>{{ guide.updated_at|date:"d/m/Y" }}</td>
										<td>
											<a class="ps-1" href="{{ guide.document.url }}">
												{% bs_icon 'filetype-pdf' size='1.3em' %}
											</a>
										</td>
										{% if user.is_staff %}
											<td>
												<a class="common" href="/admin/guides/guide/{{ guide.id }}">{% translate "Edit" %}</a>
											</td>
										{% endif %}
									</tr>
								{% endfor %}
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	{% endfor %}
</div>

<script>
$(function () {
	$(".tablesorter").tablesorter();
});
function updateRequired() {
	$('form').each(function (i, form) {
		var attending = $(form).find('[name="attending"]').val() === 'True';
		$(form).find('select[name!="attending"]').each(function (i, select) {
			$(select).prop('required', attending);
			$(select).prop('disabled', !attending);
		});
	});
}
$('[name="attending"]').change(updateRequired);
updateRequired();
</script>

{% endblock %}
